<!--@+leo-ver=5-thin-->
<!--@+node:swot.20260220153302.1: * @file index.html-->
<!--@@language html-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”®çš‡ä»ªè¡¨ç›˜ | Keystroke Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!--@+<< style >>-->
    <!--@+node:swot.20260220153543.1: ** << style >>-->
    <!--@delims /* */ -->
    <style>
        /*@+<< first-screen >>*/
        /*@+node:swot.20260223095049.1: *3* << first-screen >>*/
        /*@@language css*/
        /* é¦–å±å®¹å™¨æ ·å¼ */
        .first-screen {
            display: flex;
            flex-direction: column;
            /* 100vh å‡å» body çš„ä¸Šä¸‹ 2rem padding (å…± 4rem) */
            min-height: calc(100vh - 4rem); 
            margin-bottom: 2rem; 
        }

        /*@-<< first-screen >>*/
        /*@+<< scroll indicator style >>*/
        /*@+node:swot.20260223103734.1: *3* << scroll indicator style >>*/
        /*@@language css*/
        /* å‘ä¸‹æ»šåŠ¨æŒ‡ç¤ºå™¨ */
        .scroll-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            cursor: pointer;
            padding-top: 1.5rem; /* å’Œå›¾è¡¨æ‹‰å¼€ä¸€ç‚¹è·ç¦» */
            transition: color 0.3s ease;
        }

        .scroll-indicator:hover {
            color: var(--accent); /* é¼ æ ‡æ‚¬æµ®æ—¶äº®èµ· */
        }

        .scroll-indicator span {
            font-size: 0.85rem;
            letter-spacing: 2px;
            margin-bottom: 0.3rem;
        }

        .scroll-indicator svg {
            width: 24px;
            height: 24px;
            animation: bounce 2s infinite; /* ç»‘å®šè·³åŠ¨åŠ¨ç”» */
        }

        /* å®šä¹‰è·³åŠ¨åŠ¨ç”» */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }
        /*@-<< scroll indicator style >>*/
        /*@+<< header style >>*/
        /*@+node:swot.20260220183334.1: *3* << header style >>*/
        /*@@language css*/
        .header { text-align: center; margin-bottom: 3rem; }
        .header h1 { font-size: 2.5rem; letter-spacing: 2px; color: var(--accent); }
        .header p { color: var(--text-muted); margin-top: 0.5rem; }
        /*@-<< header style >>*/
        /*@+<< 4 cards style >>*/
        /*@+node:swot.20260220193929.1: *3* << 4 cards style >>*/
        /*@@language css*/
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: all 0.5s ease; /* å”¤é†’æ—¶æ¢å¤é€Ÿåº¦ç¨å¿«ï¼Œæ›´çµæ• */
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .stat-title {
            font-size: 1rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .stat-value {
          font-size: 2.3rem;
          font-weight: bold;
          color: var(--text-main);
        }
        .stat-value.keyboard {
            color: var(--success);
        }
        .stat-value.mouse {
            color: var(--purple);
        }
        .stat-value.focus {
            color: var(--focus);
        }
        /*@-<< 4 cards style >>*/
        /*@+<< charts style >>*/
        /*@+node:swot.20260220194042.1: *3* << charts style >>*/
        /*@@language css*/
        .charts-row-split {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            flex: 1; /* å…³é”®ï¼šè‡ªåŠ¨å æ® first-screen å‰©ä¸‹çš„æ‰€æœ‰é«˜åº¦ */
            margin-bottom: 0; /* ç§»é™¤åŸæ¥çš„åº•éƒ¨è¾¹è· */
        }
        .chart-container {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            display: flex;  /* å›¾è¡¨å®¹å™¨ä½¿ç”¨ flexï¼Œæ–¹ä¾¿å†…éƒ¨çš„å›¾è¡¨ 100% æ’‘å¼€ */
            flex-direction: column;
        }
        .chart {
            width: 100%;
            height: 100%;
            flex: 1;
        }

        /*@-<< charts style >>*/
        /*@+<< second-screen >>*/
        /*@+node:swot.20260223095831.1: *3* << second-screen >>*/
        /*@@language css*/
        /* å¤–åŒ…è£…ï¼šè®©ç¬¬äºŒå±ä¹Ÿæˆä¸ºç‹¬ç«‹çš„ä¸€æ•´å±ï¼Œå†…å®¹å±…ä¸­ */
        .second-screen {
            min-height: calc(100vh - 4rem); 
            display: flex;
            flex-direction: column;
            justify-content: center; 
            padding-top: 2rem; 
        }
        /* å®¹å™¨æ’ç‰ˆï¼šå–æ¶ˆç¬¬äºŒå±ç½‘æ ¼çš„è‡ªåŠ¨æ‹‰ä¼¸ï¼Œè®©å±…ä¸­æ•ˆæœç”Ÿæ•ˆ */
        .second-screen .charts-row-split {
            flex: none; 
        }
        /* ä¸ºâ€œæ€»ä½“å±•ç¤ºâ€çš„å›¾è¡¨å®¹å™¨å•ç‹¬è®¾ç½®ä¸€ä¸ªå›ºå®šé«˜åº¦ï¼Œé˜²æ­¢é«˜åº¦å¡Œé™· */
        .second-screen .chart-container {
            height: 400px; /* æˆ–è€…ä½ å–œæ¬¢çš„ä»»ä½•é«˜åº¦ */
            margin-bottom: 0;
        }
        /*@-<< second-screen >>*/
        /*@+others*/
        /*@+node:swot.20260220183022.1: *3* color var*/
        /*@@language css*/
        :root {
            --bg-color: #1a1b26; 
            --card-bg: #24283b;
            --text-main: #c0caf5;
            --text-muted: #565f89;
            --accent: #7aa2f7;
            --success: #9ece6a;
            --purple: #bb9af7;
            --warning: #e0af68;
            --focus: #f7768e;
        }
        /*@+node:swot.20260220183155.1: *3* browser reset*/
        /*@@language css*/
        * { box-sizing: border-box; margin: 0; padding: 0; }
        /*@+node:swot.20260220183201.1: *3* body & container style*/
        /*@@language css*/
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: ui-sans-serif, system-ui, -apple-system, sans-serif;
            padding: 2rem;
            transition: background-color 2s ease, filter 2s ease;
        }

        body.dormant-mode {
            background-color: #0d0e15; /* æ›´æ·±çš„æš—è‰²èƒŒæ™¯ */
            filter: brightness(0.8); /* æ•´ä½“å˜æš—ï¼Œé™ä½åˆºçœ¼æ„Ÿ */
        }

        /* æ–°å¢ï¼šä¼‘çœ æ¨¡å¼ä¸‹çš„å¡ç‰‡è”åŠ¨æ•ˆæœ */
        body.dormant-mode .stat-card {
            opacity: 0.4;             /* é™ä½å¡ç‰‡é€æ˜åº¦ï¼Œè¥é€ â€œé€€å±…å¹•åâ€æ„Ÿ */
            transform: scale(0.96);   /* å¾®å¾®ç¼©å°ï¼Œæ¨¡æ‹Ÿè§†è§‰ä¸Šçš„â€œè¿œç¦»â€ */
            filter: grayscale(0.6);   /* å¢åŠ ä¸€ç‚¹ç°åº¦ï¼Œè®©è‰²å½©ä¸å†è·³è·ƒ */
            transition: all 2s ease;  /* ç¡®ä¿è¿›å…¥ä¼‘çœ æ—¶æ˜¯ç¼“æ…¢â€œå…¥ç¡â€çš„ */
        }

        .container { max-width: 1200px; margin: 0 auto; }

        /*@+node:swot.20260220194258.1: *3* loading*/
        /*@@language css*/
        .loading {
            text-align: center;
            padding: 5rem;
            font-size: 1.5rem;
            color: var(--text-muted);
        }
        /*@+node:swot.20260221213206.1: *3* status çœ‹æ‡‚*/
        /*@@language css*/
        /* çŠ¶æ€æŒ‡ç¤ºå¾½ç«  */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-top: 10px;
            transition: all 0.5s ease;
        }
        .status-active { 
            background: rgba(158, 206, 106, 0.2); 
            color: var(--success); 
            border: 1px solid var(--success); 
        }
        .status-dormant { 
            background: rgba(247, 118, 142, 0.2); 
            color: var(--focus); 
            border: 1px solid var(--focus); 
        }
        .pulse { animation: pulse-animation 2s infinite; }

        @keyframes pulse-animation {
            0% { opacity: 1; box-shadow: 0 0 0 0 rgba(158, 206, 106, 0.4); }
            50% { opacity: 0.7; box-shadow: 0 0 0 6px rgba(158, 206, 106, 0); }
            100% { opacity: 1; box-shadow: 0 0 0 0 rgba(158, 206, 106, 0); }
        }
        /*@-others*/
    /*@delims <!-- --> */
    </style>
    <!--@-<< style >>-->
</head>
<body>
    <!--@+<< div app >>-->
    <!--@+node:swot.20260220153934.1: ** << div app >>-->
    <!--@@language html-->
    <div id="app" class="container">
        <div v-if="loading" class="loading">
            åŠ è½½æ•°æ®ä¸­... (è¯·ç¡®ä¿å·²é€šè¿‡ HTTP Server è¿è¡Œ)
        </div>
        <div v-else>
            <div class="first-screen">
                <!--@+<< header div >>-->
                <!--@+node:swot.20260220154251.1: *3* << header div >>-->
                <!--@@language html-->
                <div class="header">
                    <h1>HP GT87 Ultra æˆ˜å†µå¤§å±</h1>
                    <p>å®æ—¶è¯»å–æœ¬åœ°ç»Ÿè®¡æ•°æ®ï¼Œæ¯ 60 ç§’è‡ªåŠ¨åˆ·æ–°</p>
                </div>
                <!--@-<< header div >>-->
                <!--@+<< 4 cards div >>-->
                <!--@+node:swot.20260220154318.1: *3* << 4 cards div >>-->
                <!--@@language html-->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">ä»Šæ—¥ä¸“æ³¨æ—¶é•¿</div>
                        <div class="stat-value focus">{{ formatDuration(liveFocusSeconds) }}</div>
                        <div :class="['status-badge', isDormant ? 'status-dormant' : 'status-active pulse']">
                            {{ isDormant ? 'ğŸ’¤ ç³»ç»Ÿä¼‘çœ ä¸­' : 'ğŸ”¥ ä¸“æ³¨æ‰“ç ä¸­' }}
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-title">å†å²æ€»ç‚¹å‡» (Total)</div>
                        <div class="stat-value">{{ formatNumber(globalStats.total) }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">æ€»é”®ç›˜æ•²å‡» (Key)</div>
                        <div class="stat-value keyboard">{{ formatNumber(globalStats.keyboard) }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">æ€»é¼ æ ‡ç‚¹å‡» (Mouse)</div>
                        <div class="stat-value mouse">{{ formatNumber(globalStats.mouse) }}</div>
                    </div>
                </div>
                <!--@-<< 4 cards div >>-->
                <!--@+<< today analyse >>-->
                <!--@+node:swot.20260220154401.1: *3* << today analyse >>-->
                <!--@@language html-->
                <!-- ä»Šæ—¥å±•ç¤º -->
                <div class="charts-row-split">
                    <div class="chart-container">
                        <div id="hourlyChart" class="chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="topKeysChart" class="chart"></div>
                    </div>
                </div>
                <!--@-<< today analyse >>-->
                <!--@+<< scroll indicator div >>-->
                <!--@+node:swot.20260223103416.1: *3* << scroll indicator div >>-->
                <div class="scroll-indicator" @click="scrollToSecondScreen">
                    <span>æŸ¥çœ‹æ€»æˆ˜ç»©</span>
                    <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    >
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>

                <!--@-<< scroll indicator div >>-->
            </div>
            <div class="second-screen">
                <!--@+<< total analyse >>-->
                <!--@+node:swot.20260220154415.1: *3* << total analyse >>-->
                <!--@@language html-->
                <!-- æ€»ä½“å±•ç¤º -->
                <div class="charts-row-split">
                    <div class="chart-container">
                        <div id="trendChart" class="chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="allTimeTopKeysChart" class="chart"></div>
                    </div>
                </div>
                <!--@-<< total analyse >>-->
            </div>
        </div>
    </div>
    <!--@-<< div app >>-->
    <!--@+<< script >>-->
    <!--@+node:swot.20260220154005.1: ** << script >>-->
    <!--@@language javascript-->
    <!--@delims // -->
    <script>
        const { createApp, ref, computed, watch, onMounted, nextTick } = Vue;
        createApp({
            setup() {
                //@+<< const var >>
                //@+node:swot.20260220160736.1: *3* << const var >>
                //@@language java
                const loading = ref(true);
                const globalStats = ref({ total: 0, keyboard: 0, mouse: 0, key_details: {} });
                const todayHourlyData = ref([]);
                const last7DaysData = ref({ dates: [], values: [] });
                const top10KeysData = ref({ keys: [], values: [] });
                const allTimeTopKeysData = ref({ keys: [], values: [] });

                const keyMap = {
                    'Key.space': 'â£ Space', 'Key.enter': 'â†µ Enter', 'Key.backspace': 'âŒ« Backspace',
                    'Key.cmd': 'âŒ˜ Cmd/Win', 'Key.cmd_r': 'âŒ˜ Cmd/Win', 'Key.cmd_l': 'âŒ˜ Cmd/Win',
                    'Key.alt': 'âŒ¥ Opt/Alt', 'Key.alt_l': 'âŒ¥ Opt/Alt', 'Key.alt_r': 'âŒ¥ Opt/Alt',
                    'Key.ctrl': 'âŒƒ Ctrl', 'Key.ctrl_l': 'âŒƒ Ctrl', 'Key.ctrl_r': 'âŒƒ Ctrl',
                    'Key.shift': 'â‡§ Shift', 'Key.shift_r': 'â‡§ Shift', 'Key.tab': 'â‡¥ Tab',
                    'Key.esc': 'â‹ Esc', 'Key.up': 'â†‘ Up', 'Key.down': 'â†“ Down',
                    'Key.left': 'â† Left', 'Key.right': 'â†’ Right', 'Key.caps_lock': 'â‡ª Caps',
                    'Key.delete': 'âŒ¦ Delete', 'Key.page_down': 'â‡Ÿ PgDn', 'Key.page_up': 'â‡ PgUp',
                    'Key.home': 'â†– Home', 'Key.end': 'â†˜ End'
                };

                //@-<< const var >>
                //@+<< let var >>
                //@+node:swot.20260220160655.1: *3* << let var >>
                //@@language java
                let trendChartInstance = null;
                let hourlyChartInstance = null;
                let topKeysChartInstance = null;
                let allTimeTopKeysChartInstance = null;

                //@-<< let var >>
                //@+<< formatNumber() >>
                //@+node:swot.20260220160534.1: *3* << formatNumber() >>
                //@@language java
                const formatNumber = (num) => 
                    new Intl.NumberFormat('en-US').format(num || 0);
                //@-<< formatNumber() >>
                //@+<< formatDuration(seconds) >>
                //@+node:swot.20260220155506.1: *3* << formatDuration(seconds) >>
                //@@language java
                // å°†ç§’æ•°è½¬æ¢ä¸ºå‹å¥½æ ¼å¼ (å¦‚ 3h 45m 19s)
                const formatDuration = (seconds) => {
                    if (!seconds) return '0h 0m 0s';
                    const h = Math.floor(seconds / 3600);
                    const m = Math.floor((seconds % 3600) / 60);
                    const s = Math.floor(seconds % 60);  // ç®—å‡ºä½™ä¸‹çš„ç§’æ•°

                    // è¡¥é½ä¸¤ä½æ•°ï¼Œè®©è·³åŠ¨æ›´æ•´é½ç¾è§‚ï¼ˆä¾‹å¦‚ 05sï¼‰
                    const formattedS = s.toString().padStart(2, '0');

                    if (h > 0) return `${h}h ${m}m ${formattedS}s`;
                    return `${m}m ${formattedS}s`;
                };
                //@-<< formatDuration(seconds) >>
                //@+<< scrollToSecondScreen >>
                //@+node:swot.20260223104509.1: *3* << scrollToSecondScreen >>
                // å¹³æ»‘æ»šåŠ¨åˆ°ç¬¬äºŒå±
                const scrollToSecondScreen = () => {
                    const secondScreen = document.querySelector('.second-screen');
                    if (secondScreen) {
                        secondScreen.scrollIntoView({ behavior: 'smooth' });
                    }
                };

                //@-<< scrollToSecondScreen >>
                
                // å®æ—¶è®¡ç®—æ‰€éœ€çš„å˜é‡
                const jsonFocusSeconds = ref(0); 
                const lastEventTimestamp = ref(Date.now() / 1000);
                const now = ref(Date.now() / 1000);
                const HEARTBEAT_THRESHOLD = 300; // 5åˆ†é’Ÿ

                // å…¬å¼ï¼šå®æ—¶å±•ç¤ºæ—¶é•¿ = JSONå·²å­˜æ—¶é•¿ + min(å½“å‰æ—¶é—´å·®, é˜ˆå€¼)
                const liveFocusSeconds = computed(() => {
                    const delta = now.value - lastEventTimestamp.value;
                    const contribution = Math.min(Math.max(0, delta), HEARTBEAT_THRESHOLD);
                    return jsonFocusSeconds.value + contribution;
                });

                // çŠ¶æ€åˆ¤æ–­ï¼šæ˜¯å¦å·²è¶…è¿‡å¿ƒè·³é˜ˆå€¼
                const isDormant = computed(() => {
                    return (now.value - lastEventTimestamp.value) >= HEARTBEAT_THRESHOLD;
                });
                //@+others
                //@+node:swot.20260220155002.1: *3* onMounted()
                //@@language javascript
                onMounted(() => {
                    fetchData();
                    setInterval(fetchData, 60000);  // æ¯éš” 60s åˆ·æ–°ä¸€æ¬¡
                    // setInterval(fetchData, 10000);  // æµ‹è¯•æ¯éš” 10s åˆ·æ–°ä¸€æ¬¡

                    setInterval(() => {
                        now.value = Date.now() / 1000;
                    }, 1000)

                    window.addEventListener('resize', () => {
                        hourlyChartInstance?.resize();
                        topKeysChartInstance?.resize();
                        trendChartInstance?.resize();
                        allTimeTopKeysChartInstance?.resize();
                    });
                });
                //@+node:swot.20260220155408.1: *4* fetchData()
                //@@language javascript
                const fetchData = async () => {
                    try {
                        //@+<< get global_stats.json >>
                        //@+node:swot.20260221214753.1: *5* << get global_stats.json >>
                        //@@language python
                        const timestamp = new Date().getTime();
                        const globalRes = await fetch(`key_stats/global_stats.json?t=${timestamp}`);

                        if (globalRes.ok) {
                            globalStats.value = await globalRes.json();
                            if (globalStats.value.key_details) {
                                const sortedAllTime = Object.entries(globalStats.value.key_details)
                                    .sort((a, b) => b[1] - a[1]).slice(0, 10);
                                allTimeTopKeysData.value.keys = sortedAllTime.map(item => formatKeyName(item[0])).reverse();
                                allTimeTopKeysData.value.values = sortedAllTime.map(item => item[1]).reverse();
                            }
                        }
                        //@-<< get global_stats.json >>
                        //@+<< get last 7 dates >>
                        //@+node:swot.20260220214634.1: *5* << get last 7 dates >>
                        //@@language javascript
                        const dates = getLast7Days();
                        const dailyValues = [];

                        for (const date of dates) {
                            try {
                                const res = await fetch(`key_stats/${date}.json?t=${timestamp}`);
                                if (res.ok) {
                                    const data = await res.json();
                                    dailyValues.push(data.total || 0);

                                    if (date === dates[dates.length - 1]) {
                                        // --- æ ¸å¿ƒå˜åŠ¨åŒºï¼šæ›´æ–°å®æ—¶ä¸“æ³¨æ—¶é•¿çš„åŸºå‡†å€¼ ---
                                        jsonFocusSeconds.value = data.focus_seconds || 0;
                                        // æå–åç«¯é˜²æŠ–å­˜ç›˜å‘æ¥çš„ç²¾ç¡®æ—¶é—´æˆ³ï¼Œå¦‚æœæ²¡æœ‰åˆ™ç”¨å½“å‰æ—¶é—´é˜²é”™
                                        lastEventTimestamp.value = data.last_event_timestamp || (Date.now() / 1000);
                                        // ---------------------------------------------
                                        
                                        // æå– 24 å°æ—¶çƒ­åº¦åˆ†å¸ƒ
                                        const hours = Array.from({length: 24}, (_, i) => i.toString().padStart(2, '0'));
                                        todayHourlyData.value = hours.map(h => data.hourly?.[h] || 0);
                                        
                                        // æå–ä»Šæ—¥ Top 10 æŒ‰é”®
                                        if (data.keyboard) {
                                            const sortedKeys = Object.entries(data.keyboard)
                                                .sort((a, b) => b[1] - a[1]).slice(0, 10);
                                            top10KeysData.value.keys = sortedKeys.map(item => formatKeyName(item[0])).reverse();
                                            top10KeysData.value.values = sortedKeys.map(item => item[1]).reverse();
                                        }
                                    }
                                } else {
                                    dailyValues.push(0);
                                }
                            } catch (e) {
                                dailyValues.push(0);
                            }
                        }

                        last7DaysData.value = { dates, values: dailyValues };
                        //@-<< get last 7 dates >>
                        //@+<< loading or updateCharts >>
                        //@+node:swot.20260220215428.1: *5* << loading or updateCharts >>
                        //@@language python
                        if (loading.value) {
                            loading.value = false;
                            nextTick(() => {
                                renderHourlyChart();
                                renderTopKeysChart();
                                renderTrendChart();
                                renderAllTimeTopKeysChart();
                            });
                        } else {
                            updateCharts();
                        }
                        //@-<< loading or updateCharts >>

                    } catch (error) {
                        console.error("æ•°æ®æ‹‰å–å¼‚å¸¸:", error);
                    }
                };
                //@+node:swot.20260220155528.1: *5* formatKeyName(rawName)
                //@@language javascript
                const formatKeyName = (rawName) => {
                    if (keyMap[rawName])
                        return keyMap[rawName];
                    if (rawName.startsWith('Key.')) {
                        const name = rawName.replace('Key.', '');
                        return name.charAt(0).toUpperCase() + name.slice(1);
                    }
                    return rawName.toUpperCase();
                };

                //@+node:swot.20260220155441.1: *5* getLast7Days()
                //@@language javascript
                const getLast7Days = () => {
                    const dates = [];
                    for (let i = 6; i >= 0; i--) {
                        const d = new Date();
                        d.setDate(d.getDate() - i);
                        const offset = d.getTimezoneOffset() * 60000;
                        dates.push((new Date(d - offset)).toISOString().split('T')[0]);
                    }
                    return dates;
                };

                //@+node:swot.20260220155053.1: *5* updateCharts()
                //@@language javascript
                const updateCharts = () => {
                    hourlyChartInstance?.setOption({ series: [{ data: todayHourlyData.value }] });
                    topKeysChartInstance?.setOption({
                        yAxis: { data: top10KeysData.value.keys },
                        series: [{ data: top10KeysData.value.values }]
                    });
                    trendChartInstance?.setOption({
                        xAxis: { data: last7DaysData.value.dates.map(d => d.slice(5)) },
                        series: [{ data: last7DaysData.value.values }]
                    });
                    allTimeTopKeysChartInstance?.setOption({
                        yAxis: { data: allTimeTopKeysData.value.keys },
                        series: [{ data: allTimeTopKeysData.value.values }]
                    });
                };

                //@+node:swot.20260220155329.1: *5* renderHourlyChart()
                //@@language javascript
                const renderHourlyChart = () => {
                    hourlyChartInstance = echarts.init(document.getElementById('hourlyChart'), 'dark');
                    hourlyChartInstance.setOption({
                        backgroundColor: 'transparent',
                        animationDuration: 1000,
                        animationDurationUpdate: 800,       // å¢åŠ å¹³æ»‘æ›´æ–°
                        animationEasingUpdate: 'cubicOut',  // å¢åŠ ç¼“åŠ¨æ•ˆæœ
                        title: { text: 'æ‘¸é±¼æ£€æµ‹å™¨ (ä»Šæ—¥æ—¶æ®µåˆ†å¸ƒ)', left: 'center' },
                        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                        xAxis: { type: 'category', data: Array.from({length: 24}, (_, i) => `${i}:00`), axisLine: { lineStyle: { color: '#565f89' } } },
                        yAxis: { type: 'value', splitLine: { lineStyle: { color: '#1f2335' } } },
                        series: [{
                            data: todayHourlyData.value, type: 'bar',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    { offset: 0, color: '#bb9af7' }, { offset: 1, color: '#7aa2f7' }
                                ]),
                                borderRadius: [4, 4, 0, 0]
                            }
                        }]
                    });
                };

                //@+node:swot.20260220155303.1: *5* renderTopKeysChart()
                //@@language javascript
                const renderTopKeysChart = () => {
                    topKeysChartInstance = echarts.init(document.getElementById('topKeysChart'), 'dark');
                    topKeysChartInstance.setOption({
                        backgroundColor: 'transparent',
                        title: { text: 'é”®çš‡äº‰éœ¸èµ› (ä»Šæ—¥ Top 10)', left: 'center' },
                        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                        grid: { left: '3%', right: '10%', bottom: '3%', containLabel: true },
                        xAxis: { type: 'value', splitLine: { lineStyle: { color: '#1f2335' } } },
                        yAxis: { type: 'category', data: top10KeysData.value.keys, axisLine: { lineStyle: { color: '#565f89' } } },
                        series: [{
                            data: top10KeysData.value.values, type: 'bar',
                            label: { show: true, position: 'right', color: '#c0caf5', formatter: '{c} æ¬¡' },
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                    { offset: 0, color: '#9ece6a' }, { offset: 1, color: '#73daca' }
                                ]),
                                borderRadius: [0, 4, 4, 0]
                            }
                        }]
                    });
                };

                //@+node:swot.20260220155224.1: *5* renderTrendChart()
                //@@language javascript
                const renderTrendChart = () => {
                    trendChartInstance = echarts.init(document.getElementById('trendChart'), 'dark');
                    trendChartInstance.setOption({
                        backgroundColor: 'transparent',
                        animationDuration: 1000,
                        animationDurationUpdate: 800,
                        animationEasingUpdate: 'cubicOut',
                        title: { text: 'äº§å‡ºè¶‹åŠ¿ (è¿‘ 7 å¤©)', left: 'center' },
                        tooltip: { trigger: 'axis' },
                        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                        xAxis: { type: 'category', data: last7DaysData.value.dates.map(d => d.slice(5)), axisLine: { lineStyle: { color: '#565f89' } } },
                        yAxis: { type: 'value', splitLine: { lineStyle: { color: '#1f2335' } } },
                        series: [{
                            data: last7DaysData.value.values, type: 'line', smooth: true, symbolSize: 8,
                            itemStyle: { color: '#7aa2f7' },
                            areaStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    { offset: 0, color: 'rgba(122, 162, 247, 0.5)' },
                                    { offset: 1, color: 'rgba(122, 162, 247, 0)' }
                                ])
                            }
                        }]
                    });
                };

                //@+node:swot.20260220155122.1: *5* renderAllTimeTopKeysChart()
                //@@language javascript
                const renderAllTimeTopKeysChart = () => {
                    allTimeTopKeysChartInstance = echarts.init(document.getElementById('allTimeTopKeysChart'), 'dark');
                    allTimeTopKeysChartInstance.setOption({
                        backgroundColor: 'transparent',
                        title: { text: 'å…¨æ˜æ˜Ÿæˆ˜ç»© (å†å² Top 10)', left: 'center' },
                        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                        grid: { left: '3%', right: '10%', bottom: '3%', containLabel: true },
                        xAxis: { type: 'value', splitLine: { lineStyle: { color: '#1f2335' } } },
                        yAxis: { type: 'category', data: allTimeTopKeysData.value.keys, axisLine: { lineStyle: { color: '#565f89' } } },
                        series: [{
                            data: allTimeTopKeysData.value.values, type: 'bar',
                            label: { show: true, position: 'right', color: '#c0caf5', formatter: '{c} æ¬¡' },
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                    { offset: 0, color: '#e0af68' }, { offset: 1, color: '#ff9e64' }
                                ]),
                                borderRadius: [0, 4, 4, 0]
                            }
                        }]
                    });
                };

                //@-others
                //@+<< watch dormant >>
                //@+node:swot.20260223104358.1: *3* << watch dormant >>
                // ç›‘å¬çŠ¶æ€æ”¹å˜ï¼Œåˆ‡æ¢å…¨å±€èƒŒæ™¯è‰²
                watch(isDormant, (newVal) => {
                    if (newVal) {
                        document.body.classList.add('dormant-mode');
                    } else {
                        document.body.classList.remove('dormant-mode');
                    }
                });
                //@-<< watch dormant >>
                //@+<< return >>
                //@+node:swot.20260223104813.1: *3* << return >>
                return {
                    loading,
                    globalStats,
                    formatNumber,
                    formatDuration,
                    liveFocusSeconds,
                    isDormant,
                    lastEventTimestamp,
                    scrollToSecondScreen
                };
                //@-<< return >>
            }
        }).mount('#app');
    //@delims <!-- --> 
    </script>
    <!--@-<< script >>-->
</body>
</html>
<!--@-leo-->
